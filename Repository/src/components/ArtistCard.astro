---
import type { CollectionEntry } from "astro:content";

type Props = {
  artist: CollectionEntry<"artists">;
};

const { artist } = Astro.props;

// Prepend base path to image URL if it starts with /
// BASE_URL is '/repo/' (with trailing slash), so we need to handle it correctly
const baseUrl = import.meta.env.BASE_URL.endsWith('/') 
  ? import.meta.env.BASE_URL.slice(0, -1) 
  : import.meta.env.BASE_URL;
const imageSrc = artist.data.image.src.startsWith('/') 
  ? `${baseUrl}${artist.data.image.src}`
  : artist.data.image.src;
---

<a
  href={`/${artist.id}`}
  class="artist"
  style={`--image: url('${imageSrc}');`}
  data-stagename={artist.data.stage_name}
  data-name={artist.data.name}
  data-genre={artist.data.genre}
  data-astro-prefetch
  aria-label={artist.data.name}></a>

<style>
  a {
    background-image: var(--image);
    background-size: cover;
    background-position: 50% 0%;
    aspect-ratio: 0.8;
  }
</style>
